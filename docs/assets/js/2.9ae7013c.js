(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{299:function(t,e,n){"use strict";var i=n(165),r=n(164),a=n(5),o=n(23),s=n(97),c=n(166),u=n(12),l=n(167),f=n(66),h=n(1),d=[].push,p=Math.min,g=!h((function(){return!RegExp(4294967295,"y")}));i("split",2,(function(t,e,n){var i;return i="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,n){var i=String(o(this)),a=void 0===n?4294967295:n>>>0;if(0===a)return[];if(void 0===t)return[i];if(!r(t))return e.call(i,t,a);for(var s,c,u,l=[],h=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),p=0,g=new RegExp(t.source,h+"g");(s=f.call(g,i))&&!((c=g.lastIndex)>p&&(l.push(i.slice(p,s.index)),s.length>1&&s.index<i.length&&d.apply(l,s.slice(1)),u=s[0].length,p=c,l.length>=a));)g.lastIndex===s.index&&g.lastIndex++;return p===i.length?!u&&g.test("")||l.push(""):l.push(i.slice(p)),l.length>a?l.slice(0,a):l}:"0".split(void 0,0).length?function(t,n){return void 0===t&&0===n?[]:e.call(this,t,n)}:e,[function(e,n){var r=o(this),a=null==e?void 0:e[t];return void 0!==a?a.call(e,r,n):i.call(String(r),e,n)},function(t,r){var o=n(i,t,this,r,i!==e);if(o.done)return o.value;var f=a(t),h=String(this),d=s(f,RegExp),v=f.unicode,m=(f.ignoreCase?"i":"")+(f.multiline?"m":"")+(f.unicode?"u":"")+(g?"y":"g"),b=new d(g?f:"^(?:"+f.source+")",m),y=void 0===r?4294967295:r>>>0;if(0===y)return[];if(0===h.length)return null===l(b,h)?[h]:[];for(var w=0,z=0,O=[];z<h.length;){b.lastIndex=g?z:0;var x,R=l(b,g?h:h.slice(z));if(null===R||(x=p(u(b.lastIndex+(g?0:z)),h.length))===w)z=c(h,z,v);else{if(O.push(h.slice(w,z)),O.length===y)return O;for(var S=1;S<=R.length-1;S++)if(O.push(R[S]),O.length===y)return O;z=w=x}}return O.push(h.slice(w)),O}]}),!g)},300:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},301:function(t,e,n){"use strict";var i=n(0),r=n(302).trim;i({target:"String",proto:!0,forced:n(303)("trim")},{trim:function(){return r(this)}})},302:function(t,e,n){var i=n(23),r="["+n(300)+"]",a=RegExp("^"+r+r+"*"),o=RegExp(r+r+"*$"),s=function(t){return function(e){var n=String(i(e));return 1&t&&(n=n.replace(a,"")),2&t&&(n=n.replace(o,"")),n}};t.exports={start:s(1),end:s(2),trim:s(3)}},303:function(t,e,n){var i=n(1),r=n(300);t.exports=function(t){return i((function(){return!!r[t]()||"​᠎"!="​᠎"[t]()||r[t].name!==t}))}},304:function(t,e,n){"use strict";var i=n(0),r=n(28).find,a=n(94),o=n(17),s=!0,c=o("find");"find"in[]&&Array(1).find((function(){s=!1})),i({target:"Array",proto:!0,forced:s||!c},{find:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),a("find")},305:function(t,e,n){var i=n(0),r=n(327),a=n(94);i({target:"Array",proto:!0},{fill:r}),a("fill")},326:function(t,e,n){"use strict";var i=n(0),r=n(28).every,a=n(29),o=n(17),s=a("every"),c=o("every");i({target:"Array",proto:!0,forced:!s||!c},{every:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},327:function(t,e,n){"use strict";var i=n(10),r=n(99),a=n(12);t.exports=function(t){for(var e=i(this),n=a(e.length),o=arguments.length,s=r(o>1?arguments[1]:void 0,n),c=o>2?arguments[2]:void 0,u=void 0===c?n:r(c,n);u>s;)e[s++]=t;return e}},328:function(t,e,n){var i=n(0),r=n(1),a=n(13),o=n(25).f,s=n(7),c=r((function(){o(1)}));i({target:"Object",stat:!0,forced:!s||c,sham:!s},{getOwnPropertyDescriptor:function(t,e){return o(a(t),e)}})},329:function(t,e,n){"use strict";n.d(e,"e",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return o})),n.d(e,"f",(function(){return s})),n.d(e,"a",(function(){return c})),n.d(e,"g",(function(){return u})),n.d(e,"d",(function(){return l}));n(305),n(24),n(161),n(168),n(64),n(163),n(42),n(160),n(9),n(41),n(96),n(162),n(65),n(299),n(301);var i=n(30),r=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return n.some((function(e){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()===e}))},a=function(t){return r(t,"number")?t:r(t,"string")?t.includes("%")?t.slice(0,-1)/100:~~t.replace(/px/g,""):0},o=function(t){return Math.PI/180*t},s=function(t){return[].filter.call(t,(function(t){return"\n"!==t})).join("")},c=function(t){var e=t.padding.replace(/px/g,"").split(" ").map((function(t){return~~t}))||[0],n=0,i=0,a=0,o=0;switch(e.length){case 1:n=i=a=o=e[0];break;case 2:n=i=e[0],a=o=e[1];break;case 3:n=e[0],a=o=e[1],i=e[2];break;default:n=e[0],i=e[1],a=e[2],o=e[3]}var s={paddingTop:n,paddingBottom:i,paddingLeft:a,paddingRight:o};for(var c in s)s[c]=t.hasOwnProperty(c)&&r(t[c],"string","number")?~~String(t[c]).replace(/px/g,""):s[c];return[n,i,a,o]},u=function(t,e,n,i,r,a,o){var s=Math.min(i,r);a>s/2&&(a=s/2),t.beginPath(),t.fillStyle=o,t.moveTo(e+a,n),t.lineTo(e+a,n),t.lineTo(e+i-a,n),t.arcTo(e+i,n,e+i,n+a,a),t.lineTo(e+i,n+r-a),t.arcTo(e+i,n+r,e+i-a,n+r,a),t.lineTo(e+a,n+r),t.arcTo(e,n+r,e,n+r-a,a),t.lineTo(e,n+a),t.arcTo(e,n,e+a,n,a),t.closePath(),t.fill()},l=function(t,e,n,r,a,o){var s,c=/linear-gradient\((.+)\)/.exec(o)[1].split(",").map((function(t){return t.trim()})),u=c.shift();if(u.includes("deg")){var l=function(t){return Math.tan(t/180*Math.PI)};(u=u.slice(0,-3)%360)>=0&&u<45?s=[e,n+a,e+r,n+a-r*l(u-0)]:u>=45&&u<90?s=[e,n+a,e+r-a*l(u-45),n]:u>=90&&u<135?s=[e+r,n+a,e+r-a*l(u-90),n]:u>=135&&u<180?s=[e+r,n+a,e,n+r*l(u-135)]:u>=180&&u<225?s=[e+r,n,e,n+r*l(u-180)]:u>=225&&u<270?s=[e+r,n,e+a*l(u-225),n+a]:u>=270&&u<315?s=[e,n,e+a*l(u-270),n+a]:u>=315&&u<360&&(s=[e,n,e+r,n+a-r*l(u-315)])}else u.includes("top")?s=[e,n+a,e,n]:u.includes("bottom")?s=[e,n,e,n+a]:u.includes("left")?s=[e+r,n,e,n]:u.includes("right")&&(s=[e,n,e+r,n]);var f=t.createLinearGradient.apply(t,Object(i.a)(s.map((function(t){return t>>0}))));return c.reduce((function(t,e,n){var r=e.split(" ");return 1===r.length?t.addColorStop(n,r[0]):2===r.length&&t.addColorStop.apply(t,Object(i.a)(r)),t}),f)}},358:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));n(43),n(24),n(92),n(328),n(172),n(95),n(93);function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}},362:function(t,e,n){"use strict";n(169),n(326),n(305),n(24),n(304),n(92),n(161),n(64),n(163),n(42),n(41),n(162),n(65),n(299),n(93);var i=n(358),r=n(91),a=n(30),o=n(329),s={props:{blocks:{type:Array,validator:function(t){return t.every((function(t,e){return t.padding?(t.background||console.error("blocks[".concat(e,"]缺少 background 属性")),!0):console.error("blocks[".concat(e,"]缺少 padding 属性"))}))},default:function(){return[]}},prizes:{type:Array,validator:function(t){return t.every((function(t,e){return!(t.fonts&&!t.fonts.every((function(t,n){return!!t.hasOwnProperty("text")||console.error("prizes[".concat(e,"].fonts[").concat(n,"]缺少 text 属性"))})))&&!(t.imgs&&!t.imgs.every((function(t,n){return!!t.hasOwnProperty("src")||console.error("prizes[".concat(e,"].imgs[").concat(n,"]缺少 src 属性"))})))}))},default:function(){return[]}},buttons:{type:Array,validator:function(t){return!(t.fonts&&!t.fonts.every((function(t,e){return!!t.hasOwnProperty("text")||console.error("button.fonts[".concat(e,"]缺少 text 属性"))})))&&!(t.imgs&&!t.imgs.every((function(t,e){return!!t.hasOwnProperty("src")||console.error("button.imgs[".concat(e,"]缺少 src 属性"))})))},default:function(){return[]}},defaultStyle:{type:Object,default:function(){return{}}}},data:function(){return{ctx:null,canPlay:!0,speed:0,prizeFlag:void 0,animationId:null,Radius:0,prizeDeg:360,prizeRadian:0,prizeRadius:0,maxBtnRadius:0,rotateDeg:0,prizeImgs:[],btnImgs:[]}},computed:{_defaultStyle:function(){var t={fontSize:"18px",fontColor:"#000",fontStyle:"sans-serif, STHeiti, SimHei",background:"#fff",prizeGutter:"0px",wordWrap:!0,lengthLimit:"90%",speed:20};for(var e in this.defaultStyle)t[e]=this.defaultStyle[e];return t.speed=t.speed>>0,t}},watch:{prizes:{handler:function(t,e){var n=this,i=[];return e?t&&t.forEach((function(t,r){var a=[],o=e[r];o?t.imgs&&t.imgs.forEach((function(t,e){var i=o.imgs[e];i&&n.prizeImgs[r]&&n.prizeImgs[r][e]?t.src!==i.src&&(a[e]=t):a[e]=t})):a=t.imgs,i[r]=a})):i=t.map((function(t){return t.imgs})),this.init(i)},deep:!0},buttons:{handler:function(t,e){var n=this,i=[];return e?t&&t.forEach((function(t,r){var a=[],o=e[r];o&&o.imgs?t.imgs&&t.imgs.forEach((function(t,e){var i=o.imgs[e];i&&n.btnImgs[r]&&n.btnImgs[r][e]?t.src!==i.src&&(a[e]=t):a[e]=t})):a=t.imgs,i[r]=a})):i=t.map((function(t){return t.imgs})),this.init([].concat(Object(a.a)(new Array(this.prizes.length).fill()),Object(a.a)(i)))},deep:!0},blocks:{handler:function(){this.init()},deep:!0}},mounted:function(){var t;this.dpr=window.devicePixelRatio||2;var e=[];this.prizes&&(e=this.prizes.map((function(t){return t.imgs}))),this.buttons&&(t=e).push.apply(t,Object(a.a)(this.buttons.map((function(t){return t.imgs})))),this.init(e),window.addEventListener("resize",this.init.bind(this))},methods:{init:function(t){var e=this,n=this.dpr,i=this.$refs.luckDraw;if(!i)return!1;var r=this.$refs.luckDraw.childNodes[0];this.ctx=r.getContext("2d");var a=this.ctx;r.width=r.height=i.offsetWidth*n,this.Radius=r.width/2;var s=function(t){return(t*n-t)/(t*n)*(n/2)*100};r.style="transform: scale(".concat(1/n,") translate(\n        ").concat(-s(this.Radius),"%,\n        ").concat(-s(this.Radius),"%\n      )"),a.translate(this.Radius,this.Radius);var c=function(){e.draw(),r.onmousedown=function(t){return a.beginPath(),a.arc(0,0,e.maxBtnRadius,0,2*Math.PI,!1),!!a.isPointInPath(t.offsetX,t.offsetY)&&(!!e.canPlay&&void e.$emit("start",t))}},u=0,l=0;Object(o.e)(t,"array")&&(this.draw(),t.forEach((function(t,n){if(!t)return!1;t.forEach((function(t,i){l++,e.loadAndCacheImg(n,i,(function(){u++,l===u&&c.call(e)}))}))}))),l||c.call(this)},loadAndCacheImg:function(t,e,n){var i=this,r=t<this.prizes.length,a=r?"prizes":"buttons",o=r?"prizeImgs":"btnImgs";t=r?t:t-this.prizes.length;var s=this[a][t];if(!s)return!1;var c=s.imgs[e];if(!c)return!1;var u=new Image;this[o][t]||(this[o][t]=[]),this[o][t][e]=u,u.src=c.src,u.onload=function(){return n.call(i)}},computedWidthAndHeight:function(t,e,n,i){if(!e.width&&!e.height)return[t.width,t.height];if(e.width&&!e.height){var r=this.getWidth(e.width,n);return[r,t.height*(r/t.width)]}if(!e.width&&e.height){var a=this.getHeight(e.height,i);return[t.width*(a/t.height),a]}return[this.getWidth(e.width,n),this.getHeight(e.height,i)]},draw:function(){var t=this,e=this.ctx,n=this.dpr,i=this._defaultStyle;e.clearRect(2*-this.Radius,2*-this.Radius,2*this.Radius,2*this.Radius),this.prizeRadius=this.blocks.reduce((function(t,i){return e.beginPath(),e.fillStyle=i.background,e.arc(0,0,t,0,2*Math.PI,!1),e.fill(),t-Object(o.c)(i.padding.split(" ")[0])*n}),this.Radius),this.prizeDeg=360/this.prizes.length,this.prizeRadian=Object(o.b)(this.prizeDeg);var a=Object(o.b)(-90+this.rotateDeg),s=function(n){return t.getOffsetX(e.measureText(n).width)},c=function(e,r){var a=e.lineHeight||i.lineHeight||e.fontSize||i.fontSize;return t.getHeight(e.top)+(r+1)*Object(o.c)(a)*n};e.save(),this.prizes.forEach((function(u,l){var f=a+l*t.prizeRadian;e.beginPath(),e.fillStyle=u.background||i.background,e.moveTo(0,0),e.arc(0,0,t.prizeRadius,f-t.prizeRadian/2,f+t.prizeRadian/2,!1),e.fill();var h=Math.cos(f)*t.prizeRadius,d=Math.sin(f)*t.prizeRadius;e.translate(h,d),e.rotate(f+Object(o.b)(90)),u.imgs&&u.imgs.forEach((function(n,i){if(!t.prizeImgs[l])return!1;var a=t.prizeImgs[l][i];if(!a)return console.error("错误273: 没有奖品图片");var o=t.computedWidthAndHeight(a,n,t.prizeRadian*t.prizeRadius,t.prizeRadius-t.maxBtnRadius),s=Object(r.a)(o,2),c=s[0],u=s[1];e.drawImage(a,t.getOffsetX(c),t.getHeight(n.top),c,u)})),u.fonts&&u.fonts.forEach((function(r){e.fillStyle=r.fontColor||i.fontColor,e.font="".concat(Object(o.c)(r.fontSize||i.fontSize)*n,"px ").concat(r.fontStyle||i.fontStyle);var a=[],u=String(r.text);if(r.hasOwnProperty("wordWrap")?r.wordWrap:i.wordWrap){u=Object(o.f)(u);for(var l="",f=0;f<u.length;f++){l+=u[f];var h=e.measureText(l).width,d=(t.prizeRadius-c(r,a.length))*Math.tan(t.prizeRadian/2)*2;h>t.getWidth(r.lengthLimit||i.lengthLimit,d)&&(a.push(l.slice(0,-1)),l=u[f])}l&&a.push(l),a.length||a.push(u)}else a=u.split("\n");a.filter((function(t){return!!t})).forEach((function(t,n){e.fillText(t,s(t),c(r,n))}))})),e.rotate(Object(o.b)(360)-f-Object(o.b)(90)),e.translate(-h,-d)})),e.restore(),this.buttons.forEach((function(a,u){var l=t.getHeight(a.radius);t.maxBtnRadius=Math.max(t.maxBtnRadius,l),e.beginPath(),e.fillStyle=a.background,e.arc(0,0,l,0,2*Math.PI,!1),e.fill(),a.pointer&&(e.beginPath(),e.fillStyle=a.background,e.moveTo(-l,0),e.lineTo(l,0),e.lineTo(0,2*-l),e.closePath(),e.fill()),a.imgs&&a.imgs.forEach((function(n,i){if(!t.btnImgs[u])return!1;var o=t.btnImgs[u][i];if(!o)return console.error("错误339: 没有按钮图片");var s=t.computedWidthAndHeight(o,n,2*t.getHeight(a.radius),2*t.getHeight(a.radius)),c=Object(r.a)(s,2),l=c[0],f=c[1];e.drawImage(o,t.getOffsetX(l),t.getHeight(n.top),l,f)})),a.fonts&&a.fonts.forEach((function(t){e.fillStyle=t.fontColor||i.fontColor,e.font="".concat(Object(o.c)(t.fontSize||i.fontSize)*n,"px ").concat(t.fontStyle||i.fontStyle),String(t.text).split("\n").forEach((function(n,i){e.fillText(n,s(n),c(t,i))}))}))}))},play:function(){if(!this.canPlay)return!1;cancelAnimationFrame(this.animationId),this.prizeFlag=void 0,this.canPlay=!1,this.speed=0,this.run()},run:function(){var t=this.speed,e=this.prizeFlag,n=this.prizeDeg,i=this.rotateDeg,r=this._defaultStyle;if(t>=r.speed&&void 0!==e&&i%360>e*n&&i%360<e*n+n)return this.slowDown();t<r.speed&&(this.speed+=.1),this.rotateDeg+=t,this.draw(),this.animationId=window.requestAnimationFrame(this.run)},stop:function(t){this.prizeFlag=t%this.prizes.length},slowDown:function(){var t=this;if(this.speed<1){var e=360-this.prizeFlag*this.prizeDeg;if(Math.abs(this.rotateDeg%360-e)<=1)return cancelAnimationFrame(this.animationId),this.speed=0,this.canPlay=!0,this.$emit("end",Object(i.a)({},this.prizes.find((function(e,n){return n===t.prizeFlag})))),!1}else this.speed<2?this.speed-=.02:this.speed-=.05;this.rotateDeg+=this.speed,this.draw(),this.animationId=window.requestAnimationFrame(this.slowDown)},getWidth:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.prizeRadian*this.prizeRadius;return Object(o.e)(t,"number")?t*this.dpr:Object(o.e)(t,"string")?t.includes("%")?t.slice(0,-1)/100*e:t.replace(/px/g,"")*this.dpr:0},getHeight:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.prizeRadius;return Object(o.e)(t,"number")?t*this.dpr:Object(o.e)(t,"string")?t.includes("%")?t.slice(0,-1)/100*e:t.replace(/px/g,"")*this.dpr:0},getOffsetX:function(t){return-t/2}}},c=n(40),u=Object(c.a)(s,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{ref:"luckDraw",staticStyle:{overflow:"hidden"}},[e("canvas")])}),[],!1,null,null,null);e.a=u.exports}}]);